
Screenshot 2026-01-21 at 5.26.29 PM.png

<!DOCTYPE html> <html> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Duplicate Checker</title> <style> * { box-sizing: border-box; margin: 0; padding: 0; } body { font-family: -apple-system

pasted

here is github script, I want to change the styling so it matches rest of jotform:

5:31 PM
I'll help you update the styling to match the Jotform design. Let me create a revised HTML file with styling that matches the screenshot.


Creating updated HTML file with Jotform-matching styling
duplicate-checker-jotform-styled.html

Presented file
I've updated the styling to match your Jotform design. Key changes include:

Visual Updates:

Light purple background (
#f3f3fe) matching Jotform
Cleaner header with larger, lighter font
Removed card-style shadow, now full-width white sections
Updated colors: blue (
#0099ff), red (
#d93a00), green (
#00a651)
Softer borders and more subtle hover states
Required asterisks in red
"Type your answer here..." placeholder text
Layout:

Separated header and content sections with horizontal divider
Increased padding and spacing to match Jotform's generous whitespace
Inputs limited to 480px width like Jotform fields
Better mobile responsiveness
All the duplicate checking functionality remains unchanged!

Duplicate checker jotform styled
Code ¬∑ HTML 


Want to be notified when Claude responds?



Claude is AI and can make mistakes. Please double-check responses.
Duplicate checker jotform styled ¬∑ HTML
Copy

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Duplicate Checker</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background: #f3f3fe;
      padding: 0;
      margin: 0;
    }
    
    .container {
      max-width: 100%;
      margin: 0;
      background: white;
      padding: 0;
    }
    
    .header {
      background: white;
      padding: 40px 60px;
      border-bottom: 1px solid #e8e8e8;
    }
    
    .header h2 {
      font-size: 32px;
      font-weight: 400;
      color: #2c3345;
      margin-bottom: 12px;
      letter-spacing: -0.5px;
    }
    
    .header p {
      color: #6f76a7;
      font-size: 15px;
      line-height: 1.6;
      font-weight: 400;
    }
    
    .content {
      padding: 40px 60px;
      background: white;
    }
    
    .form-group {
      margin-bottom: 32px;
    }
    
    label {
      display: block;
      margin-bottom: 10px;
      font-weight: 400;
      color: #2c3345;
      font-size: 15px;
    }
    
    label .required {
      color: #d93a00;
      margin-left: 2px;
    }
    
    .validation-input {
      width: 100%;
      max-width: 480px;
      padding: 12px 14px;
      font-size: 15px;
      border: 1px solid #c3c8d8;
      border-radius: 4px;
      transition: all 0.2s;
      font-family: inherit;
      background: white;
    }
    
    .validation-input:focus {
      outline: none;
      border-color: #0099ff;
      box-shadow: 0 0 0 3px rgba(0, 153, 255, 0.15);
    }
    
    .validation-input:hover:not(:focus) {
      border-color: #a0a6bd;
    }
    
    .validation-input.error {
      border-color: #d93a00;
      background-color: #fff5f5;
    }
    
    .validation-input.success {
      border-color: #00a651;
      background-color: #f5fff9;
    }
    
    .validation-input.checking {
      border-color: #0099ff;
      background-color: #f7fbff;
    }
    
    .message {
      padding: 16px 18px;
      border-radius: 4px;
      margin-top: 20px;
      display: none;
      font-size: 14px;
      line-height: 1.6;
      max-width: 600px;
    }
    
    .error-message {
      background-color: #fff5f5;
      color: #c7350a;
      border: 1px solid #ffd4d4;
      border-left: 4px solid #d93a00;
    }
    
    .success-message {
      background-color: #f5fff9;
      color: #00652e;
      border: 1px solid #c3f0d8;
      border-left: 4px solid #00a651;
    }
    
    .loading {
      color: #0099ff;
      font-style: normal;
      margin-top: 12px;
      font-size: 14px;
    }
    
    .normalized-display {
      font-size: 13px;
      color: #8b91a7;
      margin-top: 8px;
      font-style: italic;
    }
    
    .pdf-link {
      display: inline-block;
      margin-top: 14px;
      padding: 10px 18px;
      background-color: #0099ff;
      color: white;
      text-decoration: none;
      border-radius: 4px;
      font-weight: 500;
      font-size: 14px;
      transition: background-color 0.2s;
    }
    
    .pdf-link:hover {
      background-color: #0077cc;
    }
    
    .match-details {
      margin-top: 14px;
      padding: 14px;
      background-color: #fafafa;
      border-radius: 4px;
      font-size: 13px;
      color: #2c3345;
      line-height: 1.8;
    }
    
    .match-details strong {
      display: inline-block;
      min-width: 90px;
      color: #5a6079;
    }
    
    .match-details div {
      margin-bottom: 6px;
    }
    
    .match-details div:last-child {
      margin-bottom: 0;
    }

    @media (max-width: 768px) {
      .header, .content {
        padding: 30px 20px;
      }
      
      .header h2 {
        font-size: 26px;
      }
      
      .validation-input {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h2>Check for Duplicate Invoice</h2>
      <p>
        Input full details below so that there are no delays in processing your invoice entry or payment request.
      </p>
    </div>
    
    <div class="content">
      <div class="form-group">
        <label for="vendorInput">
          Vendor Name <span class="required">*</span>
        </label>
        <input 
          type="text" 
          id="vendorInput" 
          class="validation-input" 
          placeholder="Type your answer here..."
        />
        <div id="vendorNormalized" class="normalized-display"></div>
      </div>

      <div class="form-group">
        <label for="invoiceInput">
          Invoice Number <span class="required">*</span>
        </label>
        <input 
          type="text" 
          id="invoiceInput" 
          class="validation-input" 
          placeholder="Type your answer here..."
        />
        <div id="invoiceNormalized" class="normalized-display"></div>
      </div>

      <div id="loadingMessage" class="loading" style="display:none;">
        üîç Checking for duplicates...
      </div>
      <div id="errorMessage" class="message error-message"></div>
      <div id="successMessage" class="message success-message"></div>
    </div>
  </div>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxFHNEEsEgY-OfK39Uck8KPUl2blN7HA8fxJHxzPTNkR6wtqSTT_bpaIGF739a5M9JSPw/exec';
    
    const vendorInput = document.getElementById('vendorInput');
    const invoiceInput = document.getElementById('invoiceInput');
    const vendorNormalized = document.getElementById('vendorNormalized');
    const invoiceNormalized = document.getElementById('invoiceNormalized');
    const errorMessage = document.getElementById('errorMessage');
    const successMessage = document.getElementById('successMessage');
    const loadingMessage = document.getElementById('loadingMessage');
    
    let debounceTimer;
    let isValid = false;
    
    // ‚úÖ MATCHES Apps Script normalizeInvoice()
    function normalizeInvoice(invoice) {
      if (!invoice) return '';
      
      let normalized = String(invoice).trim();
      
      // 1. Remove leading # symbol
      normalized = normalized.replace(/^#/i, '');
      
      // 2. Remove "INV" prefix (with or without hyphen/space)
      normalized = normalized.replace(/^inv[\s-]*/i, '');
      
      // 3. Remove all punctuation (periods, hyphens, apostrophes, etc.)
      normalized = normalized.replace(/[^\w\s]/g, '');
      
      // 4. Trim again after removing punctuation
      normalized = normalized.trim();
      
      // 5. Strip leading zeros only if the result is purely numeric
      if (/^\d+$/.test(normalized)) {
        normalized = normalized.replace(/^0+/, '') || '0';
      }
      
      // 6. Convert to lowercase
      return normalized.toLowerCase();
    }
    
    // ‚úÖ MATCHES Apps Script normalizeVendor()
    function normalizeVendor(vendor) {
      if (!vendor) return '';
      
      let normalized = String(vendor).trim();
      
      // 1. Remove "Other (Not Listed) -" prefix
      normalized = normalized.replace(/^other\s*\(not\s+listed\)\s*-?\s*/i, '');
      
      // 2. Remove "- NOT IN COMPLIANCE" suffix
      normalized = normalized.replace(/\s*-\s*not\s+in\s+compliance\s*$/i, '');
      
      // 3. Remove business entity suffixes (at end of string)
      normalized = normalized.replace(/\s+(llc|inc|corp|company|co|corporation|incorporated|ltd|limited)\s*$/gi, '');
      
      // 4. Remove anything inside parentheses (including the parentheses)
      normalized = normalized.replace(/\([^)]*\)/g, '');
      
      // 5. Clean up multiple spaces and trim
      normalized = normalized.replace(/\s+/g, ' ').trim();
      
      // 6. Split into words, filter out "and", remove trailing 's' from each word, rejoin WITHOUT spaces
      const words = normalized.split(' ');
      const wordsWithoutTrailingS = words
        .filter(word => word.toLowerCase() !== 'and')
        .map(word => {
          if (word.length > 1 && word.endsWith('s')) {
            return word.slice(0, -1);
          }
          return word;
        });
      normalized = wordsWithoutTrailingS.join('');
      
      // 7. Remove any remaining non-alphanumeric characters
      normalized = normalized.replace(/[^a-zA-Z0-9]/g, '');
      
      // 8. Convert to lowercase
      return normalized.toLowerCase();
    }
    
    vendorInput.addEventListener('input', function() {
      const normalized = normalizeVendor(this.value);
      vendorNormalized.textContent = normalized ? `Normalized: ${normalized}` : '';
      triggerValidation();
    });
    
    invoiceInput.addEventListener('input', function() {
      const normalized = normalizeInvoice(this.value);
      invoiceNormalized.textContent = normalized ? `Normalized: ${normalized}` : '';
      triggerValidation();
    });
    
    function triggerValidation() {
      clearTimeout(debounceTimer);
      hideMessages();
      
      const vendor = vendorInput.value.trim();
      const invoice = invoiceInput.value.trim();
      
      if (!vendor || !invoice) {
        resetInputs();
        return;
      }
      
      vendorInput.classList.add('checking');
      invoiceInput.classList.add('checking');
      
      debounceTimer = setTimeout(() => {
        checkDuplicate(vendor, invoice);
      }, 800);
    }
    
    async function checkDuplicate(vendor, invoice) {
      showLoading();
      
      try {
        const url = `${SCRIPT_URL}?vendor=${encodeURIComponent(vendor)}&invoice=${encodeURIComponent(invoice)}`;
        const response = await fetch(url);
        const data = await response.json();
        
        hideLoading();
        
        vendorInput.classList.remove('checking');
        invoiceInput.classList.remove('checking');
        
        if (data.duplicate) {
          showError(data);
          isValid = false;
        } else {
          showSuccess(data);
          isValid = true;
        }
      } catch (error) {
        hideLoading();
        vendorInput.classList.remove('checking');
        invoiceInput.classList.remove('checking');
        console.error('Error checking duplicate:', error);
        showErrorMessage('Validation error. Please try again or contact support.');
        isValid = false;
      }
    }
    
    function showError(data) {
      vendorInput.classList.add('error');
      invoiceInput.classList.add('error');
      
      errorMessage.style.display = 'block';
      
      if (data.matchedRecord) {
        let html = `
          <strong>‚ö†Ô∏è Duplicate Invoice Found!</strong><br><br>
          This invoice reference was already submitted for this vendor.
        `;
        
        html += `<div class="match-details">`;
        if (data.matchedRecord.timestamp) {
          html += `<div><strong>Submitted:</strong> ${data.matchedRecord.timestamp}</div>`;
        }
        if (data.matchedRecord.rowNumber) {
          html += `<div><strong>Row:</strong> ${data.matchedRecord.rowNumber}</div>`;
        }
        html += `<div><strong>Reference:</strong> ${data.matchedRecord.normalizedRef}</div>`;
        html += `</div>`;
        
        if (data.matchedRecord.pdfUrl) {
          html += `<br><a href="${data.matchedRecord.pdfUrl}" target="_blank" class="pdf-link">üìÑ View Original Invoice PDF</a>`;
        }
        
        errorMessage.innerHTML = html;
      } else {
        errorMessage.innerHTML = '<strong>‚ö†Ô∏è Duplicate Found!</strong><br>This vendor and invoice combination already exists.';
      }
    }
    
    function showSuccess(data) {
      vendorInput.classList.add('success');
      invoiceInput.classList.add('success');
      
      successMessage.style.display = 'block';
      successMessage.innerHTML = `
        ‚úÖ <strong>No Duplicate Found</strong><br>
        This is a unique invoice - you may proceed with your submission.<br>
        <small style="margin-top: 8px; display: block;">Reference: ${data.normalizedInput}</small>
      `;
    }
    
    function showErrorMessage(message) {
      errorMessage.style.display = 'block';
      errorMessage.innerHTML = `<strong>Error:</strong> ${message}`;
    }
    
    function showLoading() {
      loadingMessage.style.display = 'block';
    }
    
    function hideLoading() {
      loadingMessage.style.display = 'none';
    }
    
    function hideMessages() {
      errorMessage.style.display = 'none';
      successMessage.style.display = 'none';
    }
    
    function resetInputs() {
      vendorInput.classList.remove('error', 'success', 'checking');
      invoiceInput.classList.remove('error', 'success', 'checking');
      hideMessages();
      isValid = false;
    }
  </script>
</body>
</html>


